{\n  \"apiVersion\": \"argoproj.io/v1alpha1\",\n  \"kind\": \"Workflow\",\n  \"metadata\": {\n    \"namespace\": \"test\",\n    \"labels\": {\n      \"subject\": \"demo-test-01\"\n    },\n    \"name\": \"'${WORKFLOW_NAME}'\"\n  },\n  \"spec\": {\n    \"entrypoint\": \"argowf-chaos\",\n    \"serviceAccountName\": \"argo-chaos\",\n    \"securityContext\": {\n      \"runAsUser\": 1000,\n      \"runAsNonRoot\": true\n    },\n    \"arguments\": {\n      \"parameters\": [\n        {\n          \"name\": \"adminModeNamespace\",\n          \"value\": \"test\"\n        }\n      ]\n    },\n    \"templates\": [\n      {\n        \"name\": \"argowf-chaos\",\n        \"steps\": [\n          [\n            {\n              \"name\": \"install-application\",\n              \"template\": \"install-application\"\n            }\n          ],\n          [\n            {\n              \"name\": \"install-chaos-experiments\",\n              \"template\": \"install-chaos-experiments\"\n            }\n          ],\n          [\n            {\n              \"name\": \"pod-delete\",\n              \"template\": \"pod-delete\"\n            }\n          ],\n          [\n            {\n              \"name\": \"revert-chaos\",\n              \"template\": \"revert-chaos\"\n            },\n            {\n              \"name\": \"delete-application\",\n              \"template\": \"delete-application\"\n            }\n          ]\n        ]\n      },\n      {\n        \"name\": \"install-application\",\n        \"container\": {\n          \"image\": \"litmuschaos/litmus-app-deployer:latest\",\n          \"args\": [\n            \"-namespace={{workflow.parameters.adminModeNamespace}}\",\n            \"-typeName=resilient\",\n            \"-operation=apply\",\n            \"-timeout=400\",\n            \"-app=podtato-head\",\n            \"-scope=namespace\"\n          ]\n        }\n      },\n      {\n        \"name\": \"install-chaos-experiments\",\n        \"container\": {\n          \"image\": \"litmuschaos/k8s:latest\",\n          \"command\": [\n            \"sh\",\n            \"-c\"\n          ],\n          \"args\": [\n            \"kubectl apply -f https://hub.litmuschaos.io/api/chaos/2.0.0?file=charts/generic/experiments.yaml -n {{workflow.parameters.adminModeNamespace}} ; sleep 30\"\n          ]\n        }\n      },\n      {\n        \"name\": \"pod-delete\",\n        \"inputs\": {\n          \"artifacts\": [\n            {\n              \"name\": \"pod-delete\",\n              \"path\": \"/tmp/chaosengine.yaml\",\n              \"raw\": {\n                \"data\": \"apiVersion: litmuschaos.io/v1alpha1\\nkind: ChaosEngine\\nmetadata:\\n  namespace: \\\"{{workflow.parameters.adminModeNamespace}}\\\"\\n  labels:\\n    instance_id: 91d1e0d0-a84a-4e45-8492-e60c4f5ba9b0\\n  generateName: podtato-main-pod-delete-chaos\\nspec:\\n  appinfo:\\n    appns: \\\"{{workflow.parameters.adminModeNamespace}}\\\"\\n    applabel: name=podtato-main\\n    appkind: deployment\\n  engineState: active\\n  chaosServiceAccount: litmus-admin\\n  jobCleanUpPolicy: retain\\n  components:\\n    runner:\\n      imagePullPolicy: Always\\n  experiments:\\n    - name: pod-delete\\n      spec:\\n        probe:\\n          - name: check-podtato-main-access-url\\n            type: httpProbe\\n            httpProbe/inputs:\\n              url: http://podtato-main.{{workflow.parameters.adminModeNamespace}}.svc.cluster.local:9000\\n              insecureSkipVerify: false\\n              method:\\n                get:\\n                  criteria: ==\\n                  responseCode: \\\"200\\\"\\n            mode: Continuous\\n            runProperties:\\n              probeTimeout: 1\\n              interval: 1\\n              retry: 1\\n        components:\\n          env:\\n            - name: TOTAL_CHAOS_DURATION\\n              value: \\\"30\\\"\\n            - name: CHAOS_INTERVAL\\n              value: \\\"10\\\"\\n            - name: FORCE\\n              value: \\\"false\\\"\\n\"\n              }\n            }\n          ]\n        },\n        \"container\": {\n          \"image\": \"litmuschaos/litmus-checker:latest\",\n          \"args\": [\n            \"-file=/tmp/chaosengine.yaml\",\n            \"-saveName=/tmp/engine-name\"\n          ]\n        }\n      },\n      {\n        \"name\": \"delete-application\",\n        \"container\": {\n          \"image\": \"litmuschaos/litmus-app-deployer:latest\",\n          \"args\": [\n            \"-namespace={{workflow.parameters.adminModeNamespace}}\",\n            \"-typeName=resilient\",\n            \"-operation=delete\",\n            \"-app=podtato-head\"\n          ]\n        }\n      },\n      {\n        \"name\": \"revert-chaos\",\n        \"container\": {\n          \"image\": \"litmuschaos/k8s:latest\",\n          \"command\": [\n            \"sh\",\n            \"-c\"\n          ],\n          \"args\": [\n            \"kubectl delete chaosengine -l '\''instance_id in (91d1e0d0-a84a-4e45-8492-e60c4f5ba9b0, )'\'' -n {{workflow.parameters.adminModeNamespace}} \"\n          ]\n        }\n      }\n    ]\n  }\n}
